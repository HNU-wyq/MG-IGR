%part 2
      Xi = [0,1,2,3,4,5,6,7,8];
%   Xi = [0,0,0,0,1,1,1,1,2,2,2,2];
%       Xi = [0,0,1,2,3,4,5,6,7,7];
%       Xi = [0,0,1,1,2,2,3,3,4,4];
Xi = [Xi(1) Xi Xi(end)];
Eta = [0,1];
Eta = [Eta(1) Eta Eta(end)];
% Zeta = [0,0,1,1];
Zeta = [0,1,3];
Zeta = [Zeta(1) Zeta Zeta(end)];
k_ = length(Xi);
l_ = length(Eta);
m_ = length(Zeta);

s = 1/sqrt(2); r3=0.3; rr=1; rx=-1.75;rz=0.5;
B=cell(9,2,3);
B{1,1,1}=[-1   -2.5*rr   0.5   1];
B{1,1,2}=[-1   -2.8*rr   0.5  1];
B{1,1,3}=[-1   -3*rr     0.5   1];
B{1,2,1}=[rx+r3   -2.5*rr   rz   1];
B{1,2,2}=[rx+r3   -2.8*rr   rz   1];
B{1,2,3}=[rx+r3   -3*rr     rz     1];

B{2,1,1}=[-1   -2.5*rr   0   1];
B{2,1,2}=[-1   -2.8*rr   0   1];
B{2,1,3}=[-1   -3*rr     0   1];
B{2,2,1}=[rx+r3*s   -2.5*rr  rz-r3*s   1];
B{2,2,2}=[rx+r3*s  -2.8*rr   rz-r3*s   1];
B{2,2,3}=[rx+r3*s   -3*rr    rz-r3*s   1];

B{3,1,1}=[-1.75   -2.5*rr   0   1];
B{3,1,2}=[-1.75   -2.8*rr   0   1];
B{3,1,3}=[-1.75   -3*rr     0   1];
B{3,2,1}=[rx   -2.5*rr   rz-r3   1];
B{3,2,2}=[rx   -2.8*rr   rz-r3   1];
B{3,2,3}=[rx   -3*rr     rz-r3   1];

B{4,1,1}=[-2.5   -2.5*rr   0   1];
B{4,1,2}=[-2.5   -2.8*rr   0   1];
B{4,1,3}=[-2.5   -3*rr     0   1];
B{4,2,1}=[rx-r3*s   -2.5*rr   rz-r3*s   1];
B{4,2,2}=[rx-r3*s   -2.8*rr   rz-r3*s   1];
B{4,2,3}=[rx-r3*s   -3*rr     rz-r3*s   1];

B{5,1,1}=[-2.5   -2.5*rr   0.5   1];
B{5,1,2}=[-2.5   -2.8*rr   0.5   1];
B{5,1,3}=[-2.5   -3*rr     0.5   1];
B{5,2,1}=[rx-r3   -2.5*rr   rz   1];
B{5,2,2}=[rx-r3   -2.8*rr   rz   1];
B{5,2,3}=[rx-r3   -3*rr     rz   1];

B{6,1,1}=[-2.5   -2.5*rr   1   1];
B{6,1,2}=[-2.5   -2.8*rr   1   1];
B{6,1,3}=[-2.5   -3*rr     1   1];
B{6,2,1}=[rx-r3*s   -2.5*rr   rz+r3*s   1];
B{6,2,2}=[rx-r3*s   -2.8*rr   rz+r3*s   1];
B{6,2,3}=[rx-r3*s   -3*rr     rz+r3*s   1];

B{7,1,1}=[-1.75   -2.5*rr   1   1];
B{7,1,2}=[-1.75   -2.8*rr   1   1];
B{7,1,3}=[-1.75   -3*rr     1   1];
B{7,2,1}=[-1.75   -2.5*rr   rz+r3   1];
B{7,2,2}=[-1.75   -2.8*rr   rz+r3   1];
B{7,2,3}=[-1.75   -3*rr     rz+r3   1];

B{8,1,1}=[-1   -2.5*rr   1   1];
B{8,1,2}=[-1   -2.8*rr   1   1];
B{8,1,3}=[-1   -3*rr     1   1];
B{8,2,1}=[rx+r3*s   -2.5*rr   rz+r3*s   1];
B{8,2,2}=[rx+r3*s   -2.8*rr   rz+r3*s   1];
B{8,2,3}=[rx+r3*s   -3*rr     rz+r3*s   1];

B{9,1,1}=[-1   -2.5*rr   0.5   1];
B{9,1,2}=[-1   -2.8*rr   0.5  1];
B{9,1,3}=[-1   -3*rr     0.5   1];
B{9,2,1}=[rx+r3   -2.5*rr   rz   1];
B{9,2,2}=[rx+r3   -2.8*rr   rz   1];
B{9,2,3}=[rx+r3   -3*rr     rz     1];

n = size(B,1);m = size(B,2);l = size(B,3);
% Order of basis
p = k_-n-1;q = l_-m-1;r = m_ -l -1;


