
Xi = [ 0 0 0  0.5 0.5 1 1 1];
Eta = [ 0 0  0.5  1 1];
Zeta = [-0.05,0,0.05];


k_ = length(Xi);
l_ = length(Eta);
m_ = length(Zeta);

B=cell(5,2);
B{1,1} = [0 0 0.5  1];
B{2,1} = [12 0  0.5  1];
B{3,1} = [24 0  0.5  1];
B{4,1} = [36 0  0.5  1];
B{5,1} = [48 0 0.5  1];

B{1,2} = [0 8  0.5  1];
B{2,2} = [12 8  0.5  1];
B{3,2} = [24 8  0.5  1];
B{4,2} = [36 8  0.5  1];
B{5,2} = [48 8 0.5  1];
%{
% Control point net:
B=cell(5,3);
%        [x y z    w]
B{1,1} = [0 0 1/2   1];
B{2,1} = [1 0 1/2  1];
B{3,1} = [2 0 1/2  1];
B{4,1} = [3 0 1/2  1];
B{5,1} = [4 0 1/2  1];
B{1,2} = [0 1 1   1];
B{2,2} = [1 1 1  1];
B{3,2} = [2 1 1  1];
B{4,2} = [3 1 1  1]; % w ~= 1
B{5,2} = [4 1 1  1];
B{1,3} = [0 2 2  1];
B{2,3} = [1 2 2  1];
B{3,3} = [2 2 2  1];
B{4,3} = [3 2 2  1];
B{5,3} = [4 2 2  1];
%}

% Number of weights
n = size(B,1);
m = size(B,2);
l = size(B,3);

% Order of basis
p = k_-n-1;
q = l_-m-1;
r = m_ -l -1;